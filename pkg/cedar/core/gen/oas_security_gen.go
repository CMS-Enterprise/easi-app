// Code generated by ogen, DO NOT EDIT.

package api

import (
	"context"
	"net/http"
	"strings"

	"github.com/go-faster/errors"
	"github.com/ogen-go/ogen/ogenerrors"
)

// SecurityHandler is handler for security parameters.
type SecurityHandler interface {
	// HandleGatewayApikey handles GatewayApikey security.
	HandleGatewayApikey(ctx context.Context, operationName OperationName, t GatewayApikey) (context.Context, error)
	// HandleJWTKey handles JWTKey security.
	HandleJWTKey(ctx context.Context, operationName OperationName, t JWTKey) (context.Context, error)
}

func findAuthorization(h http.Header, prefix string) (string, bool) {
	v, ok := h["Authorization"]
	if !ok {
		return "", false
	}
	for _, vv := range v {
		scheme, value, ok := strings.Cut(vv, " ")
		if !ok || !strings.EqualFold(scheme, prefix) {
			continue
		}
		return value, true
	}
	return "", false
}

var operationRolesGatewayApikey = map[string][]string{
	GatewayCEDAR20Core20API200AuthorityToOperateGetOperation:             {},
	GatewayCEDAR20Core20API200BudgetGetOperation:                         {},
	GatewayCEDAR20Core20API200BudgetListDeleteOperation:                  {},
	GatewayCEDAR20Core20API200BudgetPostOperation:                        {},
	GatewayCEDAR20Core20API200BudgetPutOperation:                         {},
	GatewayCEDAR20Core20API200BudgetSystemCostFindGetOperation:           {},
	GatewayCEDAR20Core20API200ComponentPostOperation:                     {},
	GatewayCEDAR20Core20API200ContractListDeleteOperation:                {},
	GatewayCEDAR20Core20API200ContractListGetOperation:                   {},
	GatewayCEDAR20Core20API200ContractPostOperation:                      {},
	GatewayCEDAR20Core20API200ContractPutOperation:                       {},
	GatewayCEDAR20Core20API200CostTypeListGetOperation:                   {},
	GatewayCEDAR20Core20API200DeploymentDeleteOperation:                  {},
	GatewayCEDAR20Core20API200DeploymentGetOperation:                     {},
	GatewayCEDAR20Core20API200DeploymentPostOperation:                    {},
	GatewayCEDAR20Core20API200DeploymentPutOperation:                     {},
	GatewayCEDAR20Core20API200DomainModelLevelGetOperation:               {},
	GatewayCEDAR20Core20API200DomainModelListGetOperation:                {},
	GatewayCEDAR20Core20API200DomainModelNameGetOperation:                {},
	GatewayCEDAR20Core20API200EnumerationGetOperation:                    {},
	GatewayCEDAR20Core20API200ExchangeGetOperation:                       {},
	GatewayCEDAR20Core20API200ExchangeIDGetOperation:                     {},
	GatewayCEDAR20Core20API200ExchangePutOperation:                       {},
	GatewayCEDAR20Core20API200OrganizationGetOperation:                   {},
	GatewayCEDAR20Core20API200RoleGetOperation:                           {},
	GatewayCEDAR20Core20API200RoleListDeleteOperation:                    {},
	GatewayCEDAR20Core20API200RolePostOperation:                          {},
	GatewayCEDAR20Core20API200RoleTypeApplicationGetOperation:            {},
	GatewayCEDAR20Core20API200SoftwareProductsGetOperation:               {},
	GatewayCEDAR20Core20API200SoftwareProductsPostOperation:              {},
	GatewayCEDAR20Core20API200StakeholderGetOperation:                    {},
	GatewayCEDAR20Core20API200SupportContactDeleteOperation:              {},
	GatewayCEDAR20Core20API200SupportContactGetOperation:                 {},
	GatewayCEDAR20Core20API200SupportContactPostOperation:                {},
	GatewayCEDAR20Core20API200SystemDetailIDGetOperation:                 {},
	GatewayCEDAR20Core20API200SystemSummaryGetOperation:                  {},
	GatewayCEDAR20Core20API200SystemSummaryIDGetOperation:                {},
	GatewayCEDAR20Core20API200ThreatGetOperation:                         {},
	GatewayCEDAR20Core20API200URLIDGetOperation:                          {},
	GatewayCEDAR20Core20API200UserGetOperation:                           {},
	GatewayCEDAR20Core20API200UserPostOperation:                          {},
	GatewayCEDAR20Core20APIExchangePostOperation:                         {},
	GatewayCEDARIntake10ClientIDGetOperation:                             {},
	GatewayCEDARIntake10HealthCheckGetOperation:                          {},
	GatewayCEDARIntake10IntakeCedarIDGetOperation:                        {},
	GatewayCEDARIntake10IntakePostOperation:                              {},
	GatewayCEDARIntake10IntakeStatusGetOperation:                         {},
	GatewayCEDARIntake10StatusCedarIDGetOperation:                        {},
	GatewayCEDARIntake10StatusClientIDGetOperation:                       {},
	GatewayIntakeSchemaGetOperation:                                      {},
	GatewayIntakeSchemaIDDeleteOperation:                                 {},
	GatewayIntakeSchemaIDGetOperation:                                    {},
	GatewayIntakeSchemaIDPutOperation:                                    {},
	GatewayIntakeSchemaPostOperation:                                     {},
	GatewayLDAP10PersonGetOperation:                                      {},
	GatewayLDAP10PersonIDGetOperation:                                    {},
	GatewaySystem20Census20Core20API200AdminReviewerDeleteOperation:      {},
	GatewaySystem20Census20Core20API200AdminReviewerGetOperation:         {},
	GatewaySystem20Census20Core20API200AdminReviewerPostOperation:        {},
	GatewaySystem20Census20Core20API200BudgetAndContractsGetOperation:    {},
	GatewaySystem20Census20Core20API200BudgetAndContractsPostOperation:   {},
	GatewaySystem20Census20Core20API200BusinessOwnerPostOperation:        {},
	GatewaySystem20Census20Core20API200DataExchangeNotesDeleteOperation:  {},
	GatewaySystem20Census20Core20API200DataExchangeNotesGetOperation:     {},
	GatewaySystem20Census20Core20API200DataExchangeNotesPostOperation:    {},
	GatewaySystem20Census20Core20API200DataExchangeStatusDeleteOperation: {},
	GatewaySystem20Census20Core20API200DataExchangeStatusGetOperation:    {},
	GatewaySystem20Census20Core20API200DrmGetOperation:                   {},
	GatewaySystem20Census20Core20API200NoteListDeleteOperation:           {},
	GatewaySystem20Census20Core20API200NoteListGetOperation:              {},
	GatewaySystem20Census20Core20API200NotePostOperation:                 {},
	GatewaySystem20Census20Core20API200NotePutOperation:                  {},
	GatewaySystem20Census20Core20API200PageBusinessOwnerGetOperation:     {},
	GatewaySystem20Census20Core20API200PageDataCentersGetOperation:       {},
	GatewaySystem20Census20Core20API200PageDataCentersPostOperation:      {},
	GatewaySystem20Census20Core20API200PageDataExchangeGetOperation:      {},
	GatewaySystem20Census20Core20API200PageDataExchangePostOperation:     {},
	GatewaySystem20Census20Core20API200PageSoftwareProductsGetOperation:  {},
	GatewaySystem20Census20Core20API200PageSystemDataGetOperation:        {},
	GatewaySystem20Census20Core20API200PageSystemDataPostOperation:       {},
	GatewaySystem20Census20Core20API200PageSystemMaintainerGetOperation:  {},
	GatewaySystem20Census20Core20API200PageSystemsListGetOperation:       {},
	GatewaySystem20Census20Core20API200PageUrlsGetOperation:              {},
	GatewaySystem20Census20Core20API200PageUrlsPostOperation:             {},
	GatewaySystem20Census20Core20API200PersonGetOperation:                {},
	GatewaySystem20Census20Core20API200SoftwareProductsPostOperation:     {},
	GatewaySystem20Census20Core20API200StatusDeleteOperation:             {},
	GatewaySystem20Census20Core20API200StatusGetOperation:                {},
	GatewaySystem20Census20Core20API200StatusPostOperation:               {},
	GatewaySystem20Census20Core20API200SystemAiUseGetOperation:           {},
	GatewaySystem20Census20Core20API200SystemAiUsePostOperation:          {},
	GatewaySystem20Census20Core20API200SystemComponentsGetOperation:      {},
	GatewaySystem20Census20Core20API200SystemComponentsPostOperation:     {},
	GatewaySystem20Census20Core20API200SystemMaintainerPostOperation:     {},
	GatewaySystem20Census20Core20API200SystemPropertyGetOperation:        {},
	GatewaySystem20Census20Core20API200SystemPropertyPostOperation:       {},
	GatewayTechnopedia10SoftwareExtendedGetOperation:                     {},
	GatewayTechnopedia10SoftwareExtendedIDGetOperation:                   {},
	HealthGetOperation:     {},
	SparxIDDeleteOperation: {},
	SparxIDGetOperation:    {},
	SparxPostOperation:     {},
}

func (s *Server) securityGatewayApikey(ctx context.Context, operationName OperationName, req *http.Request) (context.Context, bool, error) {
	var t GatewayApikey
	const parameterName = "x-gateway-apikey"
	value := req.Header.Get(parameterName)
	if value == "" {
		return ctx, false, nil
	}
	t.APIKey = value
	t.Roles = operationRolesGatewayApikey[operationName]
	rctx, err := s.sec.HandleGatewayApikey(ctx, operationName, t)
	if errors.Is(err, ogenerrors.ErrSkipServerSecurity) {
		return nil, false, nil
	} else if err != nil {
		return nil, false, err
	}
	return rctx, true, err
}

var operationRolesJWTKey = map[string][]string{
	GatewayCEDAR20Core20API200AuthorityToOperateGetOperation:             {},
	GatewayCEDAR20Core20API200BudgetGetOperation:                         {},
	GatewayCEDAR20Core20API200BudgetListDeleteOperation:                  {},
	GatewayCEDAR20Core20API200BudgetPostOperation:                        {},
	GatewayCEDAR20Core20API200BudgetPutOperation:                         {},
	GatewayCEDAR20Core20API200BudgetSystemCostFindGetOperation:           {},
	GatewayCEDAR20Core20API200ComponentPostOperation:                     {},
	GatewayCEDAR20Core20API200ContractListDeleteOperation:                {},
	GatewayCEDAR20Core20API200ContractListGetOperation:                   {},
	GatewayCEDAR20Core20API200ContractPostOperation:                      {},
	GatewayCEDAR20Core20API200ContractPutOperation:                       {},
	GatewayCEDAR20Core20API200CostTypeListGetOperation:                   {},
	GatewayCEDAR20Core20API200DeploymentDeleteOperation:                  {},
	GatewayCEDAR20Core20API200DeploymentGetOperation:                     {},
	GatewayCEDAR20Core20API200DeploymentPostOperation:                    {},
	GatewayCEDAR20Core20API200DeploymentPutOperation:                     {},
	GatewayCEDAR20Core20API200DomainModelLevelGetOperation:               {},
	GatewayCEDAR20Core20API200DomainModelListGetOperation:                {},
	GatewayCEDAR20Core20API200DomainModelNameGetOperation:                {},
	GatewayCEDAR20Core20API200EnumerationGetOperation:                    {},
	GatewayCEDAR20Core20API200ExchangeGetOperation:                       {},
	GatewayCEDAR20Core20API200ExchangeIDGetOperation:                     {},
	GatewayCEDAR20Core20API200ExchangePutOperation:                       {},
	GatewayCEDAR20Core20API200OrganizationGetOperation:                   {},
	GatewayCEDAR20Core20API200RoleGetOperation:                           {},
	GatewayCEDAR20Core20API200RoleListDeleteOperation:                    {},
	GatewayCEDAR20Core20API200RolePostOperation:                          {},
	GatewayCEDAR20Core20API200RoleTypeApplicationGetOperation:            {},
	GatewayCEDAR20Core20API200SoftwareProductsGetOperation:               {},
	GatewayCEDAR20Core20API200SoftwareProductsPostOperation:              {},
	GatewayCEDAR20Core20API200StakeholderGetOperation:                    {},
	GatewayCEDAR20Core20API200SupportContactDeleteOperation:              {},
	GatewayCEDAR20Core20API200SupportContactGetOperation:                 {},
	GatewayCEDAR20Core20API200SupportContactPostOperation:                {},
	GatewayCEDAR20Core20API200SystemDetailIDGetOperation:                 {},
	GatewayCEDAR20Core20API200SystemSummaryGetOperation:                  {},
	GatewayCEDAR20Core20API200SystemSummaryIDGetOperation:                {},
	GatewayCEDAR20Core20API200ThreatGetOperation:                         {},
	GatewayCEDAR20Core20API200URLIDGetOperation:                          {},
	GatewayCEDAR20Core20API200UserGetOperation:                           {},
	GatewayCEDAR20Core20API200UserPostOperation:                          {},
	GatewayCEDAR20Core20APIExchangePostOperation:                         {},
	GatewayCEDARIntake10ClientIDGetOperation:                             {},
	GatewayCEDARIntake10HealthCheckGetOperation:                          {},
	GatewayCEDARIntake10IntakeCedarIDGetOperation:                        {},
	GatewayCEDARIntake10IntakePostOperation:                              {},
	GatewayCEDARIntake10IntakeStatusGetOperation:                         {},
	GatewayCEDARIntake10StatusCedarIDGetOperation:                        {},
	GatewayCEDARIntake10StatusClientIDGetOperation:                       {},
	GatewayIntakeSchemaGetOperation:                                      {},
	GatewayIntakeSchemaIDDeleteOperation:                                 {},
	GatewayIntakeSchemaIDGetOperation:                                    {},
	GatewayIntakeSchemaIDPutOperation:                                    {},
	GatewayIntakeSchemaPostOperation:                                     {},
	GatewayKeysGetOperation:                                              {},
	GatewayKeysIDDeleteOperation:                                         {},
	GatewayKeysPostOperation:                                             {},
	GatewayLDAP10PersonGetOperation:                                      {},
	GatewayLDAP10PersonIDGetOperation:                                    {},
	GatewaySystem20Census20Core20API200AdminReviewerDeleteOperation:      {},
	GatewaySystem20Census20Core20API200AdminReviewerGetOperation:         {},
	GatewaySystem20Census20Core20API200AdminReviewerPostOperation:        {},
	GatewaySystem20Census20Core20API200BudgetAndContractsGetOperation:    {},
	GatewaySystem20Census20Core20API200BudgetAndContractsPostOperation:   {},
	GatewaySystem20Census20Core20API200BusinessOwnerPostOperation:        {},
	GatewaySystem20Census20Core20API200DataExchangeNotesDeleteOperation:  {},
	GatewaySystem20Census20Core20API200DataExchangeNotesGetOperation:     {},
	GatewaySystem20Census20Core20API200DataExchangeNotesPostOperation:    {},
	GatewaySystem20Census20Core20API200DataExchangeStatusDeleteOperation: {},
	GatewaySystem20Census20Core20API200DataExchangeStatusGetOperation:    {},
	GatewaySystem20Census20Core20API200DrmGetOperation:                   {},
	GatewaySystem20Census20Core20API200NoteListDeleteOperation:           {},
	GatewaySystem20Census20Core20API200NoteListGetOperation:              {},
	GatewaySystem20Census20Core20API200NotePutOperation:                  {},
	GatewaySystem20Census20Core20API200PageBusinessOwnerGetOperation:     {},
	GatewaySystem20Census20Core20API200PageDataCentersGetOperation:       {},
	GatewaySystem20Census20Core20API200PageDataCentersPostOperation:      {},
	GatewaySystem20Census20Core20API200PageDataExchangeGetOperation:      {},
	GatewaySystem20Census20Core20API200PageDataExchangePostOperation:     {},
	GatewaySystem20Census20Core20API200PageSoftwareProductsGetOperation:  {},
	GatewaySystem20Census20Core20API200PageSystemDataGetOperation:        {},
	GatewaySystem20Census20Core20API200PageSystemDataPostOperation:       {},
	GatewaySystem20Census20Core20API200PageSystemMaintainerGetOperation:  {},
	GatewaySystem20Census20Core20API200PageSystemsListGetOperation:       {},
	GatewaySystem20Census20Core20API200PageUrlsGetOperation:              {},
	GatewaySystem20Census20Core20API200PageUrlsPostOperation:             {},
	GatewaySystem20Census20Core20API200PersonGetOperation:                {},
	GatewaySystem20Census20Core20API200SoftwareProductsPostOperation:     {},
	GatewaySystem20Census20Core20API200StatusDeleteOperation:             {},
	GatewaySystem20Census20Core20API200StatusGetOperation:                {},
	GatewaySystem20Census20Core20API200StatusPostOperation:               {},
	GatewaySystem20Census20Core20API200SystemAiUseGetOperation:           {},
	GatewaySystem20Census20Core20API200SystemAiUsePostOperation:          {},
	GatewaySystem20Census20Core20API200SystemComponentsGetOperation:      {},
	GatewaySystem20Census20Core20API200SystemComponentsPostOperation:     {},
	GatewaySystem20Census20Core20API200SystemMaintainerPostOperation:     {},
	GatewaySystem20Census20Core20API200SystemPropertyGetOperation:        {},
	GatewaySystem20Census20Core20API200SystemPropertyPostOperation:       {},
	GatewayTechnopedia10SoftwareExtendedGetOperation:                     {},
	GatewayTechnopedia10SoftwareExtendedIDGetOperation:                   {},
	HealthGetOperation:     {},
	SparxIDDeleteOperation: {},
	SparxIDGetOperation:    {},
	SparxPostOperation:     {},
}

func (s *Server) securityJWTKey(ctx context.Context, operationName OperationName, req *http.Request) (context.Context, bool, error) {
	var t JWTKey
	const parameterName = "x-jwt-key"
	value := req.Header.Get(parameterName)
	if value == "" {
		return ctx, false, nil
	}
	t.APIKey = value
	t.Roles = operationRolesJWTKey[operationName]
	rctx, err := s.sec.HandleJWTKey(ctx, operationName, t)
	if errors.Is(err, ogenerrors.ErrSkipServerSecurity) {
		return nil, false, nil
	} else if err != nil {
		return nil, false, err
	}
	return rctx, true, err
}

// SecuritySource is provider of security values (tokens, passwords, etc.).
type SecuritySource interface {
	// GatewayApikey provides GatewayApikey security value.
	GatewayApikey(ctx context.Context, operationName OperationName) (GatewayApikey, error)
	// JWTKey provides JWTKey security value.
	JWTKey(ctx context.Context, operationName OperationName) (JWTKey, error)
}

func (s *Client) securityGatewayApikey(ctx context.Context, operationName OperationName, req *http.Request) error {
	t, err := s.sec.GatewayApikey(ctx, operationName)
	if err != nil {
		return errors.Wrap(err, "security source \"GatewayApikey\"")
	}
	req.Header.Set("x-gateway-apikey", t.APIKey)
	return nil
}
func (s *Client) securityJWTKey(ctx context.Context, operationName OperationName, req *http.Request) error {
	t, err := s.sec.JWTKey(ctx, operationName)
	if err != nil {
		return errors.Wrap(err, "security source \"JWTKey\"")
	}
	req.Header.Set("x-jwt-key", t.APIKey)
	return nil
}
