version: "2"

formatters:
  enable:
    - gofmt
    - goimports
  settings:
    goimports:
      local-prefixes: github.com/cms-enterprise/easi-app

linters:
  default: none
  enable:
    - gosec
    - govet
    - ineffassign
    - revive
    - staticcheck # includes former gosimple, stylecheck, unused
    - exhaustive
    - sqlclosecheck
  settings:
    gosec:
      # Currently excluding rule G602 due to issue slowing down execution
      # https://github.com/securego/gosec/issues/1010
      # If we ever re-enable this rule, make sure https://github.com/securego/gosec/issues/1005 is also fixed
      excludes:
        - "G602"
    govet:
      enable:
        - shadow
      settings:
        printf:
          funcs:
            - (github.com/golangci/golangci-lint/pkg/logutils.Log).Infof
            - (github.com/golangci/golangci-lint/pkg/logutils.Log).Warnf
            - (github.com/golangci/golangci-lint/pkg/logutils.Log).Errorf
            - (github.com/golangci/golangci-lint/pkg/logutils.Log).Fatalf
    revive:
      confidence: 0.1 # Default is 0.8. We want to ignore things that have an extremely low confidence level
    exhaustive:
      # Presence of "default" case in switch statements satisfies exhaustiveness,
      # even if all enum members are not listed.
      # Default: false
      default-signifies-exhaustive: true
  exclusions:
    generated: disable
    presets:
      - comments
    rules:
      - text: "ST1000" # Exclude package comments from `stylecheck`
      - text: 'shadow: declaration of "err" shadows declaration at'
        linters: [govet]
    paths:
      - "pkg/graph/generated/generated.go" # Since we don't ignore _all_ generated files, we have to ignore this one specifically
      - "pkg/models/models_gen.go" # Since we don't ignore _all_ generated files, we have to ignore this one specifically

run:
  timeout: 8m
  concurrency: 1
